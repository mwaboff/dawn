/* Base card layout */
.card {
  position: relative;
  display: flex;
  flex-direction: column;
  cursor: pointer;
  transition: max-height 0.4s ease-out, transform 0.3s ease, box-shadow 0.3s ease;
  overflow: clip;
  max-height: 340px;
  border-radius: 12px;
  background: linear-gradient(160deg, #2d2520, #231e18 50%, #1a1610);
  border: 1px solid #3a3020;
  box-shadow: 0 4px 16px rgba(0,0,0,.5);
}
.card::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 80px;
  background: linear-gradient(to bottom, transparent, #1a1610);
  z-index: 4;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.card:focus-visible { outline: 3px solid #d4a056; outline-offset: 4px; }
.card:hover { transform: translateY(-5px); box-shadow: 0 12px 35px rgba(0,0,0,.5), 0 0 40px var(--cg); border-color: var(--cd); }
.card:hover .card__decoration { opacity: 1; }
.card.card--selected { border-color: var(--ca); box-shadow: 0 6px 24px rgba(0,0,0,.4), 0 0 50px var(--cg), inset 0 0 30px var(--cg); max-height: 520px; transition: max-height 0.5s ease-in, transform 0.3s ease, box-shadow 0.3s ease; }
.card.card--selected::before { opacity: 0; }
.card__content {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  padding: 2rem 1.75rem 2.5rem;
}
.card--selected .card__content { overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--ca) #2d2520; }
.card--selected .card__content::-webkit-scrollbar { width: 6px; }
.card--selected .card__content::-webkit-scrollbar-track { background: #2d2520; border-radius: 3px; }
.card--selected .card__content::-webkit-scrollbar-thumb { background: var(--ca); border-radius: 3px; }
.card--selected .card__content::-webkit-scrollbar-thumb:hover { background: #e0b46a; }
.card__header, .card__body, .card__tags, .card__features { position: relative; z-index: 2; }
.card__body { flex: 1; }
.card__name { font-family: 'Cinzel', serif; font-weight: 900; margin: 0; line-height: 1.2; font-size: 1.65rem; color: #faf7f4; letter-spacing: .08em; text-transform: uppercase; }
.card__subtitle { margin: 0.25rem 0 1rem; font-family: 'Lora', serif; font-size: 1rem; color: var(--ca); text-transform: uppercase; letter-spacing: .12em; }
.card__description { font-family: 'Lora', serif; margin: 0; font-size: 1.05rem; color: #ddd0c2; line-height: 1.75; }
.card__type-badge { position: absolute; z-index: 5; font-family: 'Lora', serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; pointer-events: none; bottom: .75rem; right: .75rem; font-size: .8rem; color: var(--ca); opacity: .75; }
.card__tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: auto; padding-top: 0.75rem; border-top: 1px solid rgba(212,160,86,.15); }
.card__tag { font-family: 'Lora', serif; font-weight: 600; font-size: .9rem; text-transform: uppercase; letter-spacing: 0.08em; color: var(--ca); padding: .2rem 0; }
.card__tag + .card__tag::before { content: '\b7'; margin-right: .5rem; opacity: .4; }
.card__decoration { position: absolute; inset: 0; pointer-events: none; z-index: 1; border-radius: 12px; opacity: 0; transition: opacity .4s ease; background: linear-gradient(135deg, var(--cg), transparent 30%, transparent 70%, var(--cg)); }
.card__decoration::before, .card__decoration::after { content: ''; position: absolute; width: 16px; height: 16px; border-color: var(--cd); border-style: solid; border-width: 0; }
.card__decoration::before { top: 6px; left: 6px; border-top-width: 2px; border-left-width: 2px; border-radius: 4px 0 0 0; }
.card__decoration::after { bottom: 6px; right: 6px; border-bottom-width: 2px; border-right-width: 2px; border-radius: 0 0 4px 0; }

/* Card type accent colors */
.card--type-class { --ca: #d4a056; --cd: rgba(212,160,86,.3); --cg: rgba(212,160,86,.15); }
.card--type-subclass { --ca: #b87fd4; --cd: rgba(184,127,212,.3); --cg: rgba(184,127,212,.15); }
.card--type-heritage { --ca: #d45656; --cd: rgba(212,86,86,.3); --cg: rgba(212,86,86,.15); }
.card--type-community { --ca: #56d478; --cd: rgba(86,212,120,.3); --cg: rgba(86,212,120,.15); }
.card--type-ancestry { --ca: #d4c256; --cd: rgba(212,194,86,.3); --cg: rgba(212,194,86,.15); }
.card--type-domain { --ca: #d48056; --cd: rgba(212,128,86,.3); --cg: rgba(212,128,86,.15); }

/* Selected state */
.card--selected::after {
  content: '\2713'; position: absolute; top: .5rem; right: .5rem;
  width: 1.5rem; height: 1.5rem; display: flex; align-items: center; justify-content: center;
  background: var(--ca); color: #1a1412;
  font-size: .75rem; font-weight: 900; border-radius: 50%; z-index: 5; line-height: 1;
}

/* Features section */
.card__features { border-top: 1px solid rgba(212,160,86,.15); margin-top: .75rem; padding-top: .5rem; }
.card__features-toggle {
  display: flex; align-items: center; gap: .4rem;
  background: none; border: none; cursor: pointer; padding: .25rem 0;
  font-family: 'Cinzel', serif; font-size: .9rem; font-weight: 600;
  color: var(--ca); text-transform: uppercase; letter-spacing: .08em;
}
.card__features-toggle:hover { opacity: .85; }
.card__features-toggle-icon { display: inline-block; transition: transform .2s ease; font-size: .75rem; }
.card__features-toggle-icon--expanded { transform: rotate(90deg); }
.card__features-list { max-height: 0; overflow: hidden; transition: max-height .3s ease; }
.card__features-list--expanded { max-height: 2000px; overflow: visible; }
/* Wide variant */
.card--wide { max-height: none; flex-direction: row; }
.card--wide::before { display: none; }
.card--wide .card__content { flex-direction: row; padding: 0; }
.card--wide .card__header {
  flex-shrink: 0; width: 240px; display: flex; flex-direction: column;
  justify-content: center; align-items: center; text-align: center;
  padding: 2rem 1.75rem; border-right: 1px solid var(--cd); position: relative;
  background: linear-gradient(180deg, rgba(212,160,86,.06), transparent 50%, rgba(212,160,86,.04));
}
.card--wide .card__header::after {
  content: ''; position: absolute; right: -1px; top: 12px; bottom: 12px;
  width: 1px; background: linear-gradient(180deg, transparent, var(--ca), transparent); opacity: .35;
}
.card--wide .card__name { font-size: 1.5rem; letter-spacing: .12em; }
.card--wide .card__subtitle { margin: .5rem 0 0; font-size: .9rem; }
.card--wide .card__body { flex: 1; min-width: 0; padding: 1.5rem 1.75rem; display: flex; flex-direction: column; }
.card--wide .card__description { font-size: 1rem; }
.card--wide .card__tags { margin-top: .75rem; padding-top: .5rem; }
.card--wide .card__features { margin-top: .5rem; }
.card--wide .card__features-list { columns: 1; }
.card--wide .card__feature-item { break-inside: avoid; }
.card--wide .card__type-badge { top: .75rem; right: .75rem; bottom: auto; }
.card--wide:hover { transform: translateY(-3px); }
.card--wide.card--selected { max-height: none; }
.card--wide.card--selected .card__content { overflow-y: visible; }
@media (max-width: 640px) {
  .card--wide, .card--wide .card__content { flex-direction: column; }
  .card--wide .card__header { width: auto; border-right: none; border-bottom: 1px solid var(--cd); padding: 1.5rem; }
  .card--wide .card__header::after { right: 12px; left: 12px; top: auto; bottom: -1px; width: auto; height: 1px; background: linear-gradient(90deg, transparent, var(--ca), transparent); }
  .card--wide .card__body { padding: 1.25rem; }
  .card--wide .card__features-list { columns: 1; }
}

.card--disabled { opacity: 0.5; pointer-events: none; filter: grayscale(0.3); }
